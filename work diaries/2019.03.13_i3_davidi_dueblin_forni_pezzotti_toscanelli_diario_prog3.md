# GESTIONE CASINÒ | Diario di lavoro - 13.03.2019
##### Matan Davidi, Thor Düblin, Matteo Forni, Carlo Pezzotti, Mattia Toscanelli
### Trevano, 13 marzo 2019

## Lavori svolti
Durante la giornata di oggi, Matan ha dovuto aggiungere una colonna alla tabella user del database dove deve venir inserita la data e l'ora della registrazione di un utente in modo da poter usare questo dato per cancellare eventuali utenti non confermati dopo un giorno dalla loro registrazione. Un evento pianificato per essere avviato ogni 12 ore si occupa di cancellare questi utenti. Inoltre ha dovuto creare un trigger che si accertasse che la data di registrazione non fosse nulla, in caso contrario deve essere inserita la data e l'ora dell'inserimento.

Questo può essere fatto con il seguente codice:
```SQL
ALTER TABLE cashyland.user ADD COLUMN registration_date DATETIME;

USE cashyland;

DELIMITER //

CREATE EVENT IF NOT EXISTS delete_unverified_users
ON SCHEDULE EVERY 12 HOUR
DO
BEGIN
	DELETE FROM cashyland.user WHERE verified = 0 AND registration_date <= subdate(NOW(), 1);
END
//
```

Invece il trigger viene creato con il codice seguente:

```SQL
USE cashyland;

DELIMITER //

CREATE TRIGGER before_user_insert BEFORE INSERT ON user
FOR EACH ROW
BEGIN
	IF NEW.registration_date IS NULL THEN
		SET NEW.registration_date = NOW();
    END IF;
END
//

```

##  Problemi riscontrati e soluzioni adottate


##  Punto della situazione rispetto alla pianificazione
Rispetto alla pianificazione siamo in orario.

## Programma di massima per la prossima giornata di lavoro
